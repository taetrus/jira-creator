*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg: #0f1117;
  --surface: #1a1d2e;
  --border: #2d3150;
  --text: #e2e8f0;
  --muted: #8892b0;
  --primary: #5a67d8;
  --primary-hover: #4c56c0;
  --ok: #48bb78;
  --err: #fc8181;
  --dry: #63b3ed;
  --skip: #f6ad55;
  --info: #718096;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

body { background: var(--bg); color: var(--text); min-height: 100vh; }

.app { max-width: 900px; margin: 0 auto; padding: 0 1rem 3rem; }

/* Header */
.app-header {
  padding: 1.5rem 0 0;
  border-bottom: 1px solid var(--border);
  margin-bottom: 2rem;
}
.app-header h1 { font-size: 1.4rem; font-weight: 600; margin-bottom: 1rem; color: var(--text); }
.tabs { display: flex; gap: 0; }
.tab {
  padding: 0.6rem 1.4rem;
  background: none;
  border: 1px solid var(--border);
  border-bottom: none;
  color: var(--muted);
  cursor: pointer;
  font-size: 0.9rem;
  border-radius: 6px 6px 0 0;
  margin-right: 4px;
  transition: all 0.15s;
}
.tab:hover { color: var(--text); background: var(--surface); }
.tab.active { background: var(--surface); color: var(--text); border-color: var(--border); }

/* Main content */
.app-main { }
.section { background: var(--surface); border: 1px solid var(--border); border-radius: 0 8px 8px 8px; padding: 2rem; }
.section h2 { font-size: 1.1rem; margin-bottom: 1.5rem; color: var(--text); }
.section h3 { font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--muted); margin: 1.5rem 0 0.75rem; }

/* Forms */
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
label { display: flex; flex-direction: column; gap: 0.3rem; font-size: 0.85rem; color: var(--muted); }
input, select, textarea {
  background: var(--bg);
  border: 1px solid var(--border);
  color: var(--text);
  border-radius: 5px;
  padding: 0.45rem 0.7rem;
  font-size: 0.9rem;
  width: 100%;
  outline: none;
  transition: border-color 0.15s;
}
input:focus, select:focus, textarea:focus { border-color: var(--primary); }
select option { background: var(--bg); }

/* Buttons */
.btn-row { display: flex; gap: 0.75rem; align-items: center; margin-top: 1.25rem; flex-wrap: wrap; }
button {
  padding: 0.5rem 1.2rem;
  border-radius: 5px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text);
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.15s;
}
button:hover { background: var(--border); }
button:disabled { opacity: 0.5; cursor: not-allowed; }
button.primary { background: var(--primary); border-color: var(--primary); color: #fff; }
button.primary:hover:not(:disabled) { background: var(--primary-hover); }
.link-btn { background: none; border: none; color: var(--primary); padding: 0; text-decoration: underline; font-size: inherit; }
.link-btn:hover { background: none; }

/* Status message */
.status-msg { margin-top: 1rem; padding: 0.6rem 0.9rem; border-radius: 5px; font-size: 0.88rem; background: var(--bg); border: 1px solid var(--border); }
.status-msg.ok { border-color: var(--ok); color: var(--ok); }
.status-msg.err { border-color: var(--err); color: var(--err); word-break: break-all; }

.hint { font-size: 0.8rem; color: var(--muted); font-weight: normal; }

/* Fields discovery table */
.fields-table-wrap { margin-top: 1.5rem; overflow-x: auto; }
.fields-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
.fields-table th { text-align: left; padding: 0.5rem 0.75rem; color: var(--muted); border-bottom: 1px solid var(--border); }
.fields-table td { padding: 0.4rem 0.75rem; border-bottom: 1px solid var(--border); }
.fields-table tbody tr { cursor: pointer; }
.fields-table tbody tr:hover { background: rgba(90,103,216,0.1); }
.fields-table code { font-size: 0.8rem; color: var(--dry); }

/* Parse step */
.file-area { margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
.md-input { font-family: 'Fira Code', 'Courier New', monospace; font-size: 0.82rem; resize: vertical; min-height: 180px; }

/* Preview tree */
.preview { margin-top: 1.5rem; }
.counts { display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem; font-size: 0.85rem; color: var(--muted); }
.counts strong { color: var(--text); }
.tree { border: 1px solid var(--border); border-radius: 6px; padding: 0.75rem 1rem; margin-bottom: 1rem; font-size: 0.88rem; max-height: 400px; overflow-y: auto; }
.tree details { margin: 0.25rem 0; }
.tree summary { cursor: pointer; list-style: none; padding: 0.2rem 0; }
.tree summary::-webkit-details-marker { display: none; }
.tree-epic { font-weight: 600; color: var(--text); }
.tree-story-wrap { margin-left: 1.5rem; }
.tree-story { color: var(--dry); }
.tree-subtasks { margin-left: 2rem; list-style: none; color: var(--muted); }
.tree-subtasks li { padding: 0.15rem 0; }
.sp { color: var(--skip); font-size: 0.8rem; margin-left: 0.3rem; }

/* Create step */
.dry-run-label { display: flex; align-items: center; gap: 0.4rem; font-size: 0.88rem; color: var(--muted); cursor: pointer; flex-direction: row; }
.dry-run-label input { width: auto; }

/* Log */
.log {
  margin-top: 1.25rem;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 0.75rem;
  max-height: 450px;
  overflow-y: auto;
  font-family: 'Fira Code', 'Courier New', monospace;
  font-size: 0.82rem;
}
.log-line { display: flex; gap: 0.75rem; padding: 0.2rem 0; }
.log-tag { min-width: 36px; font-weight: 700; }
.log-line.ok .log-tag { color: var(--ok); }
.log-line.err .log-tag { color: var(--err); }
.log-line.info .log-tag { color: var(--info); }
.log-line.skip .log-tag { color: var(--skip); }
.log-line.dry .log-tag { color: var(--dry); }
.log-line.err { color: var(--err); }
